{
  "hash": "827f50ded403686b5994a3be1aa9f7f4",
  "result": {
    "markdown": "---\ntitle: \"AUDPC in Real Data\"\nauthor: \"Sith Jaisong\"\ndate: '2021-11-19'\ncategories: [R, PDE]\ndraft: TRUE\n---\n\n# เกริ่น\nบทความนี้จะมาแสดงให้เห็นประโยชน์และการใช้ประโยชน์ที่ได้จากการพิจารณาการพัฒนาของโรคเมื่อเวลาผ่านไปว่ามีความแตต่างกันอย่างไร ถ้าพันธุ์พืชไม่เหมือนกัน หรือ วิธีการจัดการที่แตกต่างกัน\nการศึกษารูปแบบการพัฒนาของโรคเมื่อเวลาผ่านไป จะช่วยตัดสินใจ เพื่อเลือกใช้ วิธีการใดเพื่อ ลดค่า AUDPC เพราะว่า ค่านี้ มีความสัมพันธุ์กับผลผลิต\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0      ✔ purrr   1.0.1 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.3.0      ✔ stringr 1.5.0 \n✔ readr   2.1.3      ✔ forcats 1.0.0 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(knitr)\nlibrary(patchwork)\nlibrary(ggthemes)\nlibrary(rmarkdown)\ntheme_set(theme_few())\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\noptions(digits = 3)\n```\n:::\n\n# ตัวอย่างการศึกษาการต้านทานโรคและการใช้สารเคมีป้องกันกำจัดโรคต่อการพัฒนาของโรคสนิมในใบข้าวสาลี\n\nผลกระทบของการต้านทานโรคและการใช้สารฆ่าเชื้อราต่อความก้าวหน้าของโรคสนิมในใบข้าวสาลีสามารถประเมินได้โดยใช้ AUDPC โดยทั่วไป การต้านทานเป็นวิธีที่ดีที่สุดในการควบคุมโรคทางใบในข้าวสาลี เช่น สนิมแถบและสนิมใบ (เกิดจาก **Puccinia triticina**)\n\nข้อมูลแปลงจาก [Suggested exercise:Using the area under the disease progress curve to compare disease severity](https://www.apsnet.org/edcenter/disimpactmngmnt/topc/EcologyAndEpidemiologyInR/DiseaseProgress/Pages/StripeRust.aspx) แสดงให้เห็นถึงความแตกต่างในความรุนแรงของโรคสำหรับพันธุ์ที่ไวต่อการเกิดสนิมของพันธุ์ Jagger และ พันธุ์ต้านทาน 2137 และ Cutter\nนอกจากนี้ การทดลองนี้ศึกษาเรื่องระยะเวลาการฉีดพ้นสารป้องกันกำจัดโรค ซึ่งระยะเวลาเป็นสิ่งสำคัญ หากจะใช้สารเคมีกำจัดโรคเพื่อควบคุมโรคราสนิมของข้าวสาลี โดยทั่วไป สารเคมีป้องกันกำจัดเชื้อราจะมีผลเพียงสองสัปดาห์หลังการใช้ เพื่อป้องกันการติดเชื้อใหม่ในช่วงเวลานั้น และไม่แนะนำให้ใช้หลังออกดอก ดังนั้นช่วงเวลาที่สำคัญสำหรับการใช้สารเคมีป้องกันกำจัดโรคคือ 2 สัปดาห์ก่อนออกดอก การสูญเสียพื้นทีใบเพื่อ่สังเคราะห์แสงจะส่งผลให้สูญเสียผลผลิตมากที่สุด เมื่อพ้นช่วง 2 สัปดาห์นี้ การสูญเสียการติดเชื้อครั้งใหม่จะรุนแรงน้อยกว่ามาก\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse) # เพื่อจักการขอ้มูล\nlibrary(stringr) # เพือจัดการข้อมูล\nlibrary(epifitter) # เพื่อใช้ AUDPC()\n```\n:::\n\n## ข้อมูล\n\n::: {.cell}\n\n```{.r .cell-code}\nrust_dat <- read_csv(file = \"https://www.apsnet.org/edcenter/disimpactmngmnt/topc/EcologyAndEpidemiologyInR/DiseaseProgress/Documents/FungicideExample.csv\", col_types = \"ddddddd\" )\nrust_dat\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 9 × 7\n  Julian.Date TwentyOneThirtySevenWheat Twenty…¹ Cutte…² Cutte…³ Jagge…⁴ Jagge…⁵\n        <dbl>                     <dbl>    <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1          97                      0        0       0       0       0       0   \n2         104                      0        0       0       0       0       0   \n3         111                      0        0       0       0       0       0   \n4         118                      0        0       0       0       0       0   \n5         125                      0        0       0       0       0       0   \n6         132                      0        0       0       0       0       0   \n7         139                      2.34     1.81    1.15    1.79    1.85    2.27\n8         146                      7.56     7.89    3.62    2.4     6.92    5   \n9         154                     28.8     15.0    17.9     6.21   47.4    20.2 \n# … with abbreviated variable names ¹​TwentyOneThirtySevenWheat.trt,\n#   ²​CutterWheat, ³​CutterWheat.Trt, ⁴​JaggerWheat, ⁵​JaggerWheat.Trt\n```\n:::\n:::\n\nข้อมูลตาราง 7 ตัวแปร Julian.Date คือ วันที่ของปี ซึ่งประเมินโรค 9 ครั้ง ทุก ๆ 7 วัน เริ่มตั้งแต่วันที่ 97 คือวันที่ 97 104 11 118 125 132 139 146 154 บันทึกใน คอลัมน์ต่อไปๆ คือ พันธ์ข้าวสาลต่าง ๆ และ ีที่ไม่ฉีดพ้น\n\nจากโครงสร้างข้อมูลนี้ ยังไม่พร้อมที่จะ นำมาวิเคราะห์ จึงต้องจัดโครงสร้างใหม่\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_rust <- rust_dat %>% pivot_longer(TwentyOneThirtySevenWheat:JaggerWheat.Trt, names_to = \"Treatment\", values_to = \"Severity\")\npaged_table(tidy_rust)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Julian.Date\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Treatment\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Severity\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"97\",\"2\":\"TwentyOneThirtySevenWheat\",\"3\":\"0.00\"},{\"1\":\"97\",\"2\":\"TwentyOneThirtySevenWheat.trt\",\"3\":\"0.00\"},{\"1\":\"97\",\"2\":\"CutterWheat\",\"3\":\"0.00\"},{\"1\":\"97\",\"2\":\"CutterWheat.Trt\",\"3\":\"0.00\"},{\"1\":\"97\",\"2\":\"JaggerWheat\",\"3\":\"0.00\"},{\"1\":\"97\",\"2\":\"JaggerWheat.Trt\",\"3\":\"0.00\"},{\"1\":\"104\",\"2\":\"TwentyOneThirtySevenWheat\",\"3\":\"0.00\"},{\"1\":\"104\",\"2\":\"TwentyOneThirtySevenWheat.trt\",\"3\":\"0.00\"},{\"1\":\"104\",\"2\":\"CutterWheat\",\"3\":\"0.00\"},{\"1\":\"104\",\"2\":\"CutterWheat.Trt\",\"3\":\"0.00\"},{\"1\":\"104\",\"2\":\"JaggerWheat\",\"3\":\"0.00\"},{\"1\":\"104\",\"2\":\"JaggerWheat.Trt\",\"3\":\"0.00\"},{\"1\":\"111\",\"2\":\"TwentyOneThirtySevenWheat\",\"3\":\"0.00\"},{\"1\":\"111\",\"2\":\"TwentyOneThirtySevenWheat.trt\",\"3\":\"0.00\"},{\"1\":\"111\",\"2\":\"CutterWheat\",\"3\":\"0.00\"},{\"1\":\"111\",\"2\":\"CutterWheat.Trt\",\"3\":\"0.00\"},{\"1\":\"111\",\"2\":\"JaggerWheat\",\"3\":\"0.00\"},{\"1\":\"111\",\"2\":\"JaggerWheat.Trt\",\"3\":\"0.00\"},{\"1\":\"118\",\"2\":\"TwentyOneThirtySevenWheat\",\"3\":\"0.00\"},{\"1\":\"118\",\"2\":\"TwentyOneThirtySevenWheat.trt\",\"3\":\"0.00\"},{\"1\":\"118\",\"2\":\"CutterWheat\",\"3\":\"0.00\"},{\"1\":\"118\",\"2\":\"CutterWheat.Trt\",\"3\":\"0.00\"},{\"1\":\"118\",\"2\":\"JaggerWheat\",\"3\":\"0.00\"},{\"1\":\"118\",\"2\":\"JaggerWheat.Trt\",\"3\":\"0.00\"},{\"1\":\"125\",\"2\":\"TwentyOneThirtySevenWheat\",\"3\":\"0.00\"},{\"1\":\"125\",\"2\":\"TwentyOneThirtySevenWheat.trt\",\"3\":\"0.00\"},{\"1\":\"125\",\"2\":\"CutterWheat\",\"3\":\"0.00\"},{\"1\":\"125\",\"2\":\"CutterWheat.Trt\",\"3\":\"0.00\"},{\"1\":\"125\",\"2\":\"JaggerWheat\",\"3\":\"0.00\"},{\"1\":\"125\",\"2\":\"JaggerWheat.Trt\",\"3\":\"0.00\"},{\"1\":\"132\",\"2\":\"TwentyOneThirtySevenWheat\",\"3\":\"0.00\"},{\"1\":\"132\",\"2\":\"TwentyOneThirtySevenWheat.trt\",\"3\":\"0.00\"},{\"1\":\"132\",\"2\":\"CutterWheat\",\"3\":\"0.00\"},{\"1\":\"132\",\"2\":\"CutterWheat.Trt\",\"3\":\"0.00\"},{\"1\":\"132\",\"2\":\"JaggerWheat\",\"3\":\"0.00\"},{\"1\":\"132\",\"2\":\"JaggerWheat.Trt\",\"3\":\"0.00\"},{\"1\":\"139\",\"2\":\"TwentyOneThirtySevenWheat\",\"3\":\"2.34\"},{\"1\":\"139\",\"2\":\"TwentyOneThirtySevenWheat.trt\",\"3\":\"1.81\"},{\"1\":\"139\",\"2\":\"CutterWheat\",\"3\":\"1.15\"},{\"1\":\"139\",\"2\":\"CutterWheat.Trt\",\"3\":\"1.79\"},{\"1\":\"139\",\"2\":\"JaggerWheat\",\"3\":\"1.85\"},{\"1\":\"139\",\"2\":\"JaggerWheat.Trt\",\"3\":\"2.27\"},{\"1\":\"146\",\"2\":\"TwentyOneThirtySevenWheat\",\"3\":\"7.56\"},{\"1\":\"146\",\"2\":\"TwentyOneThirtySevenWheat.trt\",\"3\":\"7.89\"},{\"1\":\"146\",\"2\":\"CutterWheat\",\"3\":\"3.62\"},{\"1\":\"146\",\"2\":\"CutterWheat.Trt\",\"3\":\"2.40\"},{\"1\":\"146\",\"2\":\"JaggerWheat\",\"3\":\"6.92\"},{\"1\":\"146\",\"2\":\"JaggerWheat.Trt\",\"3\":\"5.00\"},{\"1\":\"154\",\"2\":\"TwentyOneThirtySevenWheat\",\"3\":\"28.78\"},{\"1\":\"154\",\"2\":\"TwentyOneThirtySevenWheat.trt\",\"3\":\"15.04\"},{\"1\":\"154\",\"2\":\"CutterWheat\",\"3\":\"17.89\"},{\"1\":\"154\",\"2\":\"CutterWheat.Trt\",\"3\":\"6.21\"},{\"1\":\"154\",\"2\":\"JaggerWheat\",\"3\":\"47.39\"},{\"1\":\"154\",\"2\":\"JaggerWheat.Trt\",\"3\":\"20.17\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nโครงสร้างข้อมูลพร้อมวิเคราะห์ต่อแล้ว\nต่อไป ดูกราฟ การพัฒนาของโรคเมื่อเวลาผ่านไปว่าแต่ละกรรมวิธีนั้น เป็นอย่างไรนั้น\n\n## ปรับโครงสร้างข้อมูล\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_rust %>%\n  ggplot(aes(x = Julian.Date, y = Severity, color = Treatment)) + geom_point() + geom_line() + labs(color = \"Treatment\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n## กราฟ disease progress over time  \nถ้ามาดูกราฟ แยกกันในแต่ละพันธุ์ เปรียบเทียบระหว่าง ไม่พ้นสารเคมี กับพ่น\n\n::: {.cell}\n\n```{.r .cell-code}\nCutter_p <- tidy_rust %>%\n  filter(str_detect(Treatment, \"Cutter\")) %>%\n  ggplot(aes(x = Julian.Date, y = Severity, color = Treatment)) + geom_point() + geom_line()\n\nJagger_p <- tidy_rust %>%\n  filter(str_detect(Treatment, \"Jagger\")) %>%\n  ggplot(aes(x = Julian.Date, y = Severity, color = Treatment)) + geom_point() + geom_line()\n\nTwenty_p <- tidy_rust %>%\n  filter(str_detect(Treatment, \"Twenty\")) %>%\n  ggplot(aes(x = Julian.Date, y = Severity, color = Treatment)) + geom_point() + geom_line()\n\nCutter_p / Jagger_p / Twenty_p\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\nจะเห็นชัดเจนมากขึ้นว่า ถ้าฉีดพ้นแล้ว การพัฒนาของโรคพืชเมื่อเวลาผ่านไปลดลง\n\n\n::: {.cell}\n\n```{.r .cell-code}\nVar_p <- tidy_rust %>%\n  filter(!str_detect(Treatment, \"rt$\")) %>%\n  ggplot(aes(x = Julian.Date, y = Severity, color = Treatment)) + geom_point() + geom_line()\nVar_p\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\nข้อมูลชุดนี้เอง ก็สามารถบ่งบอกว่าพันธุ์ใดมีความต้านทานต่อโรคราสนิมมากกว่ากัน จากกราฟ ก็พอจะบอกได้ว่า พันธุ์ Cutter นั้น ต้านทานโรคมากกว่าอีก 2 พันธุ์\n\n### คำนวน audpc \n\nมาดูวิธีการวิเคราะห์หาค่า AUDPC กันด้วย `epifitter::AUDPC()` มันมีทริคนิดหน่วยครับ เพราะว่า function ถูกออกแบบมาให้คำนวน audpc ข้อมูลชุดใดชุดหนึ่ง ดังนั้นถ้า ชุดข้อมูลมีหลาย Treatment ก็จะต้อง คำนวน audpc แต่ละ Treament ซึ่ง อาสจจะต้อง subset ข้อมูลก่อนแล้วจึงจะ คำนวนหาค่า audpc ได้\n\nซึ่งสำหรับข้อมูลจริง อาจจะต้องพึ่ง package `tidyr` และ `purrr` ดังตัวอย่างที่ทำให้ดู\n\nืnested ข้อมูลส่วนที่เป็น Julian.Date และ Severity ด้วยการ `group_by` และ `nest`\n\n::: {.cell}\n\n```{.r .cell-code}\nnst_rust <- tidy_rust %>% group_by(Treatment) %>% nest()\nnst_rust\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n# Groups:   Treatment [6]\n  Treatment                     data            \n  <chr>                         <list>          \n1 TwentyOneThirtySevenWheat     <tibble [9 × 2]>\n2 TwentyOneThirtySevenWheat.trt <tibble [9 × 2]>\n3 CutterWheat                   <tibble [9 × 2]>\n4 CutterWheat.Trt               <tibble [9 × 2]>\n5 JaggerWheat                   <tibble [9 × 2]>\n6 JaggerWheat.Trt               <tibble [9 × 2]>\n```\n:::\n:::\n\nต่อจากนั้น `map_dbl` ต่อโดยรวบ function `AUDPC`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrust_audpc <- nst_rust %>% mutate(audpc = map_dbl(data, ~AUDPC(time = .x$Julian.Date, y = .x$Severity)))\n```\n:::\n\nได้ ค่า AUDPC ใน column ชื่อ audpc\n\nลอง plot กราฟ ดู\n\n::: {.cell}\n\n```{.r .cell-code}\nrust_audpc %>% ggplot(aes(x = Treatment, y = audpc)) + geom_col() + coord_flip()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\nลองเอาไปฝึกกันดูนะ\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}