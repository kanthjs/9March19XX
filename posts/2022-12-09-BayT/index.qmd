---
title: "Introduction to Bayesian Statistics in R"
date: '2022-12-09'
categories: [R]
---

# บทนำ

Bayesian Statistics เป็นแนวทางทางสถิติที่ได้รับความนิยมมากขึ้นในปัจจุบัน โดยใช้แนวคิดของ **ทฤษฎีบทของเบย์ (Bayes' Theorem)** เป็นแกนหลัก

ลองนึกภาพง่ายๆ เช่น การทำนายว่าพรุ่งนี้ฝนจะตกหรือไม่:

-   นักสถิติแบบดั้งเดิม (Frequentist) จะดูว่าในอดีต วันที่มีสภาพอากาศแบบนี้ฝนตกกี่ครั้งจากร้อยครั้ง แต่

-   นักสถิติแบบ Bayesian จะเริ่มจากความเชื่อเดิม (เช่น เป็นหน้าฝน น่าจะตก 70%) แล้วปรับความเชื่อตามข้อมูลใหม่ที่ได้ (เช่น เมฆครึ้ม ความกดอากาศต่ำ)

ในบทความนี้ เราจะมาทำความเข้าใจพื้นฐานของสถิติแบบเบย์ เปรียบเทียบกับ Frequentist และดูตัวอย่างง่ายๆ ใน R เพื่อให้เห็นภาพที่ชัดเจนขึ้น

# เปรียบเทียบ Bayesian กับ Frequentist

| ประเด็น | Frequentist | Bayesian |
|----|----|----|
| แนวคิดเกี่ยวกับความน่าจะเป็น | **"มองจากความถี่ที่เกิดขึ้น"** เช่น ถ้าปลูกข้าว 100 แปลง พบโรคไหม้ 30 แปลง = โอกาสเป็นโรค 30% | **"มองจากความเชื่อที่ปรับได้"** เช่น เริ่มจากพื้นที่นี้เคยพบโรค 30% + ปีนี้ฝนชุก = อาจปรับความเชื่อเป็น 45% |
| การอนุมานพารามิเตอร์ | **"หาค่าที่เป็นไปได้มากที่สุด"** เช่น จากข้อมูลการทดลองพบว่า ยาฆ่าเชื้อมีประสิทธิภาพ 75% | **"รวมความรู้เดิมกับข้อมูลใหม่"** เช่น จากประสบการณ์เดิม 70% + ผลทดลองใหม่ 75% = ปรับเป็น 73% |
| การตีความค่า p-value | **"ถ้าสมมติว่ายาไม่ได้ผล โอกาสที่จะเห็นผลการทดลองแบบนี้มีแค่ 5%"** | **"จากข้อมูลที่มี โอกาสที่ยาจะได้ผลคือ 95%"** |
| ความยืดหยุ่น | จำกัดด้วยข้อมูลที่มีอยู่เท่านั้น | สามารถนำความรู้และประสบการณ์เดิมมาใช้ประกอบการวิเคราะห์ |

# ทฤษฎีบทของเบย์ (Bayes' Theorem)

สมการพื้นฐานของ Bayes' Theorem คือ:

$P(θ|D) = \frac{P(D|θ)P(θ)}{P(D)}$

ลองยกตัวอย่างในการวินิจฉัยโรคใบไหม้ในนาข้าว:

-   **Prior (P(θ))**: จากประสบการณ์ในพื้นที่นี้ พบโรคใบไหม้ 30% ของแปลงทั้งหมด
-   **Likelihood (P(D\|θ))**: การตรวจด้วยชุดตรวจโรคให้ผลบวก 90% ในแปลงที่เป็นโรคจริง
-   **Evidence (P(D))**: โอกาสที่จะพบผลบวกในทุกกรณี
-   **Posterior (**P(θ\|D)**)**: ความเชื่อใหม่ว่าแปลงนี้เป็นโรคหลังจากพบผลตรวจเป็นบวก

# ตัวอย่างการคำนวณ Bayes' Theorem ใน R

ลองมาคำนวณโอกาสที่แปลงข้าวจะเป็นโรคใบไหม้เมื่อผลตรวจเป็นบวก:

```{r}
# กำหนดค่าตามข้อมูลที่มี
prior <- 0.30        # ความชุกของโรคในพื้นที่ (30%)
sensitivity <- 0.90  # ความแม่นยำเมื่อเป็นโรค (90%)
specificity <- 0.85  # ความแม่นยำเมื่อไม่เป็นโรค (85%)

# คำนวณโอกาสที่จะพบผลบวก
p_positive <- (sensitivity * prior) + ((1 - specificity) * (1 - prior))

# คำนวณ Posterior
posterior <- (sensitivity * prior) / p_positive

# แสดงผลลัพธ์
print(paste("โอกาสที่แปลงนี้จะเป็นโรคเมื่อผลตรวจเป็นบวก:", round(posterior * 100, 1), "%"))
```

# บทสรุป

การใช้ Bayesian Statistics ในงานวิจัยโรคพืชมีประโยชน์หลายด้าน:

1\. สามารถนำความรู้และประสบการณ์เดิมมาใช้ในการวิเคราะห์

2\. ให้ผลลัพธ์ที่เข้าใจง่ายในรูปของความน่าจะเป็น

3\. สามารถปรับปรุงการประเมินได้เมื่อมีข้อมูลใหม่

4\. เหมาะสำหรับการประเมินความเสี่ยงและการพยากรณ์การระบาด
